function [xp, xm, Pp, Pm, Qp, Qm] = sbp_staggered_6(n,h)
% [xp, xm, Pp, Pm, Qp, Qm] = sbp_staggered_6(n, h)
% Input arguments:
% n : number of grid points  (n+1) xp grid (n+2) xm grid
% h : grid spacing

assert(n >= 9, 'Not enough grid points');  

% Coefficients determined such that the SBP property is satisfied
qp44 = -144662434693018337/131093333881896960;
pp3 = 793/720;
qp22 = -729260819980499/780317463582720;
pm5 = 1262401/1244160;
pp4 = 157/160;
qp03 = -1056618403248889/17835827739033600;
qp32 = 17518644727427/2340952390748160;
pm4 = 224201/241920;
pm2 = 90101/103680;
qp40 = -572605772036807/27311111225395200;
qp30 = 3572646778087103/61450000257139200;
pm3 = 26369/23040;
qp41 = 935926732952051/29964190601576448;
qp02 = -67953322736279/2340952390748160;
pp0 = 95/288;
qp01 = 143647626126052207/149820953007882240;
pp1 = 317/240;
qp12 = 444281115722813/468190478149632;
qp25 = 312883915256963/24970158834647040;
qp11 = -36400588465707331/37455238251970560;
qp20 = -137012145866261/13655555612697600;
qp10 = -1008199398207353/6827777806348800;
qp15 = -1088192686015471/37455238251970560;
qp04 = -239061311631881/131093333881896960;
qp35 = -2480203967217637/112365714755911680;
qp21 = 1658590350384343/24970158834647040;
qp05 = 4843362440877649/449462859023646720;
qp24 = -372310079307409/4369777796063232;
qp33 = -4809914536549211/4458956934758400;
qp23 = 2826535075774271/2972637956505600;
qp42 = 4202889834071/585238097687040;
qp14 = 492703999899311/32773333470474240;
pm1 = 133801/138240;
qp34 = 36544940032227659/32773333470474240;
qp00 = -216175739231516543/245800001028556800;
qp43 = 128340370711031/17835827739033600;
qp13 = 823082791653949/4458956934758400;
pm0 = 5251/68040;
pp2 = 23/30;
qp45 = 170687698457070187/149820953007882240;
qp31 = -3169112007572299/37455238251970560;

% Q+ and Q-, top-left corner
QpL = [...
-216175739231516543/245800001028556800, 143647626126052207/149820953007882240, -67953322736279/2340952390748160, -1056618403248889/17835827739033600, -239061311631881/131093333881896960, 4843362440877649/449462859023646720;
 -1008199398207353/6827777806348800, -36400588465707331/37455238251970560, 444281115722813/468190478149632, 823082791653949/4458956934758400, 492703999899311/32773333470474240, -1088192686015471/37455238251970560;
 -137012145866261/13655555612697600, 1658590350384343/24970158834647040, -729260819980499/780317463582720, 2826535075774271/2972637956505600, -372310079307409/4369777796063232, 312883915256963/24970158834647040;
 3572646778087103/61450000257139200, -3169112007572299/37455238251970560, 17518644727427/2340952390748160, -4809914536549211/4458956934758400, 36544940032227659/32773333470474240, -2480203967217637/112365714755911680;
 -572605772036807/27311111225395200, 935926732952051/29964190601576448, 4202889834071/585238097687040, 128340370711031/17835827739033600, -144662434693018337/131093333881896960, 170687698457070187/149820953007882240
];
QmL = [...
-29624261797040257/245800001028556800, 1008199398207353/6827777806348800, 137012145866261/13655555612697600, -3572646778087103/61450000257139200, 572605772036807/27311111225395200;
 -143647626126052207/149820953007882240, 36400588465707331/37455238251970560, -1658590350384343/24970158834647040, 3169112007572299/37455238251970560, -935926732952051/29964190601576448;
 67953322736279/2340952390748160, -444281115722813/468190478149632, 729260819980499/780317463582720, -17518644727427/2340952390748160, -4202889834071/585238097687040;
 1056618403248889/17835827739033600, -823082791653949/4458956934758400, -2826535075774271/2972637956505600, 4809914536549211/4458956934758400, -128340370711031/17835827739033600;
 239061311631881/131093333881896960, -492703999899311/32773333470474240, 372310079307409/4369777796063232, -36544940032227659/32773333470474240, 144662434693018337/131093333881896960;
 -4843362440877649/449462859023646720, 1088192686015471/37455238251970560, -312883915256963/24970158834647040, 2480203967217637/112365714755911680, -170687698457070187/149820953007882240
];

% Q+ and Q-
w = 6; 
s = [ -3/640,  25/384,  -75/64,  75/64,  -25/384,  3/640];  
Qp = spdiags(repmat(-s(end:-1:1),[n+2 1]), -(w/2-1):w/2, n+2, n+2); 
Qm = spdiags(repmat(s(:)',[n+2 1]), -(w/2-1)-1:w/2-1, n+2, n+2);
Qp(end,:) = [];
Qm(:,end) = [];

% Add SBP boundary closures
bp = 5;
bm = 6;
Qp(1:bp,1:bm) = double(QpL);
Qp(end-bp+1:end,end-bm+1:end) = -fliplr(flipud(QpL));
Qm(1:bm,1:bp) = double(QmL);
Qm(end-bm+1:end,end-bp+1:end) = -fliplr(flipud(QmL));

% P+ and P-
Pp = ones(n+1,1);
Pm = ones(n+2,1);

Pp(1:bp) = [95/288,  317/240,  23/30,  793/720,  157/160]; 
Pp(end-bp+1:end) = Pp(bp:-1:1);
Pm(1:bm) = [5251/68040,  133801/138240,  90101/103680,  26369/23040,  224201/241920,  1262401/1244160];
Pm(end-bm+1:end) = Pm(bm:-1:1);
Pp = spdiags(Pp,0,n+1,n+1);
Pm = spdiags(Pm,0,n+2,n+2);

Pp = h*Pp;
Pm = h*Pm;

xp = h*[0:n]';
xm = h*[0 1/2+0:n n]';  
